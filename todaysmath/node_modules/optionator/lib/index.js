(function(){function e(e,r){var n={}.hasOwnProperty;for(var t in r)n.call(r,t)&&(e[t]=r[t]);return e}var r,n,t,o,a,l,i,s,p,u,f,c,d,h,y,w,g,m,v,E,O,A={}.toString,b=[].slice;r="0.8.2",n=require("prelude-ls"),n.id,t=n.map,n.compact,o=n.any,n.groupBy,a=n.partition,l=n.chars,n.isItNaN,i=n.keys,n.Obj,s=n.camelize,p=require("deep-is"),n=require("./util"),u=n.closestString,f=n.nameToRaw,c=n.dasherize,d=n.naturalJoin,n=require("./help"),h=n.generateHelp,y=n.generateHelpForOption,n=require("type-check"),w=n.parsedTypeCheck,g=n.parseType,m=require("levn").parsedTypeParse,v=function(e){var r,n,t={};for(r in e)n=e[r],t[s(r)]=n;return t},E=function(e){var r,n,o;return r="--?[a-zA-Z][-a-z-A-Z0-9]*=",n=RegExp("(?:"+r+")?(?:'(?:\\\\'|[^'])+'|\"(?:\\\\\"|[^\"])+\")|[^'\"\\s]+","g"),o=RegExp("^("+r+")?['\"]([\\s\\S]*)['\"]$"),t(function(e){return e.replace(o,"$1$2")},e.match(n)||[])},O=function(r){var n,t,s,O,R,N;return n={},t={},s=[],"Undefined"===A.call(r.stdout).slice(8,-1)&&(r.stdout=process.stdout),null==r.positionalAnywhere&&(r.positionalAnywhere=!0),null==r.typeAliases&&(r.typeAliases={}),null==r.defaults&&(r.defaults={}),null!=r.concatRepeatedArrays&&(r.defaults.concatRepeatedArrays=r.concatRepeatedArrays),null!=r.mergeRepeatedObjects&&(r.defaults.mergeRepeatedObjects=r.mergeRepeatedObjects),O=function(e){function o(e){return 1===e.length}var l,i,p,u,f,c,d,h,y,w,v,E,O,R,N,T,q,x,I,j,B,P;if("Array"!==A.call(e).slice(8,-1))throw new Error("No options defined.");for(l=0,i=e.length;l<i;++l)if(p=e[l],null==p.heading){if(u=p.option,null!=n[u])throw new Error("Option '"+u+"' already defined.");for(f in c=r.defaults)d=c[f],null==p[f]&&(p[f]=d);if("Boolean"===p.type&&null==p.boolean&&(p.boolean=!0),null==p.parsedType){if(!p.type)throw new Error("No type defined for option '"+u+"'.");try{h=null!=(y=r.typeAliases[p.type])?y:p.type,p.parsedType=g(h)}catch(e){throw w=e,new Error("Option '"+u+"': Error parsing type '"+p.type+"': "+w.message)}}if(p.default)try{t[u]=m(p.parsedType,p.default)}catch(e){throw w=e,new Error("Option '"+u+"': Error parsing default value '"+p.default+"' for type '"+p.type+"': "+w.message)}if(p.enum&&!p.parsedPossiblities){for(v=[],E=p.parsedType,O=0,R=(c=p.enum).length;O<R;++O){N=c[O];try{v.push(m(E,N))}catch(e){throw w=e,new Error("Option '"+u+"': Error parsing enum value '"+N+"' for type '"+p.type+"': "+w.message)}}p.parsedPossibilities=v}if(y=p.dependsOn)if(y.length)if(c=[].concat(p.dependsOn),T=c[0],q=b.call(c,1),x=T.toLowerCase(),q.length){if("and"!==x&&"or"!==x)throw new Error("Option '"+u+"': If you have more than one dependency, you must specify either 'and' or 'or'");p.dependsOn=[x].concat(b.call(q))}else"and"===(c=x.toLowerCase())||"or"===c?p.dependsOn=null:p.dependsOn=["and",T];else p.dependsOn=null;if(p.required&&s.push(u),n[u]=p,null!=p.concatRepeatedArrays)if(I=p.concatRepeatedArrays,"Boolean"===A.call(I).slice(8,-1))p.concatRepeatedArrays=[I,{}];else if(1===I.length)p.concatRepeatedArrays=[I[0],{}];else if(2!==I.length)throw new Error("Invalid setting for concatRepeatedArrays");if(p.alias||p.aliases){if("NUM"===u)throw new Error("-NUM option can't have aliases.");for(p.alias&&null==p.aliases&&(p.aliases=[].concat(p.alias)),O=0,R=(c=p.aliases).length;O<R;++O){if(j=c[O],null!=n[j])throw new Error("Option '"+j+"' already defined.");n[j]=p}c=a(o,p.aliases),B=c[0],P=c[1],null==p.shortNames&&(p.shortNames=B),null==p.longNames&&(p.longNames=P)}p.aliases&&0!==p.shortNames.length||"Boolean"!==p.type||"true"!==p.default||(p.negateName=!0)}},O(r.options),R=function(e){var r,t;if(null==(r=n[e]))throw t=u(i(n),e),new Error("Invalid option '"+f(e)+"'"+(t?" - perhaps you meant '"+f(t)+"'?":"."));return r},N=function(a,i){var u,h,y,g,O,N,T,q,x,I,j,B,P,k,z,$,M,S,U,C,H,Z,_,F,V,L,J,D,G,K,Q,W,X,Y,ee,re,ne,te,oe;switch(u=(null!=i?i:{}).slice,h={},y=[],g=!1,O=!1,N=null,T=function(r,n){var t,a,l,i;if(t=R(r),t.boolean)a=n;else{try{l=t.concatRepeatedArrays,a=null!=l&&l[0]&&l[1].oneValuePerFlag&&1===t.parsedType.length&&"array"===t.parsedType[0].structure?[m(t.parsedType[0].of,n)]:m(t.parsedType,n)}catch(e){throw e,new Error("Invalid value for option '"+r+"' - expected type "+t.type+", received value: "+n+".")}if(t.enum&&!o(function(e){return p(e,a)},t.parsedPossibilities))throw new Error("Option "+r+": '"+a+"' not one of "+d(t.enum)+".")}i=A.call(h[r]).slice(8,-1),null!=h[r]?null!=t.concatRepeatedArrays&&t.concatRepeatedArrays[0]&&"Array"===i?h[r]=h[r].concat(a):t.mergeRepeatedObjects&&"Object"===i?e(h[r],a):h[r]=a:h[r]=a,t.restPositional&&(g=!0),t.overrideRequired&&(O=!0)},q=function(){var e,r,n;for(e in r=t)n=r[e],null==h[e]&&(h[e]=n)},x=function(){var e,r,n,t;if(!O)for(e=0,n=(r=s).length;e<n;++e)if(t=r[e],!h[t])throw new Error("Option "+f(t)+" is required.")},I=function(e,r){throw new Error("The options "+f(e)+" and "+f(r)+" are mutually exclusive - you cannot use them at the same time.")},j=function(){var e,n,t,o,a,l,i,s,p,u,f;if(e=r.mutuallyExclusive)for(n=0,t=e.length;n<t;++n)for(o=e[n],a=null,l=0,i=o.length;l<i;++l)if(s=o[l],"Array"===A.call(s).slice(8,-1)){for(p=0,u=s.length;p<u;++p)if((f=s[p])in h){if(null==a){a=f;break}I(a,f)}}else s in h&&(null!=a?I(a,s):a=s)},B=function(e){var r,n,t,o,a,l,i;if(!(r=e.dependsOn)||e.dependenciesMet)return!0;for(n=r[0],t=b.call(r,1),o=0,a=t.length;o<a;++o)if(l=t[o],(i=h[l])&&B(i)){if("or"===n)return!0}else if("and"===n)throw new Error("The option '"+e.option+"' did not have its dependencies met.");if("and"===n)return!0;throw new Error("The option '"+e.option+"' did not meet any of its dependencies.")},P=function(){var e;for(e in h)B(n[e])},k=function(){if(N)throw new Error("Value for '"+N+"' of type '"+R(N).type+"' required.")},A.call(a).slice(8,-1)){case"String":z=E(a.slice(null!=u?u:0));break;case"Array":z=a.slice(null!=u?u:2);break;case"Object":h={};for($ in a)if(M=a[$],"_"!==$){if(S=R(c($)),!w(S.parsedType,M))throw new Error("Option '"+S.option+"': Invalid type for '"+M+"' - expected type '"+S.type+"'.");h[S.option]=M}return j(),P(),q(),x(),U=v(h),U._=a._||[],U;default:throw new Error("Invalid argument to 'parse': "+a+".")}for(C=0,H=z.length;C<H;++C)if("--"===(Z=z[C]))g=!0;else if(g)y.push(Z);else if(_=Z.match(/^(--?)([a-zA-Z][-a-zA-Z0-9]*)(=)?(.*)?$/)){if(F=_,k(),V=1===F[1].length,L=F[2],J=null!=F[3],D=F[4],J&&null==D)throw new Error("No value for '"+L+"' specified.");if(V)for(G=l(L),K=G.length,Q=0,W=G.length;Q<W;++Q)if(X=Q,Y=G[Q],ee=R(Y),re=ee.option,g)y.push(Y);else if(X===K-1)J?(ne=ee.boolean?m([{type:"Boolean"}],D):D,T(re,ne)):ee.boolean?T(re,!0):N=re;else{if(!ee.boolean)throw new Error("Can't set argument '"+Y+"' when not last flag in a group of short flags.");T(re,!0)}else if(te=!1,(_=L.match(/^no-(.+)$/))?(te=!0,oe=_[1],ee=R(oe)):ee=R(L),re=ee.option,ee.boolean)ne=!J||m([{type:"Boolean"}],D),te?T(re,!ne):T(re,ne);else{if(te)throw new Error("Only use 'no-' prefix for Boolean options, not with '"+oe+"'.");J?T(re,D):N=re}}else if(_=Z.match(/^-([0-9]+(?:\.[0-9]+)?)$/)){if(!(ee=n.NUM))throw new Error("No -NUM option defined.");T(ee.option,_[1])}else N?(T(N,Z),N=null):(y.push(Z),r.positionalAnywhere||(g=!0));return k(),j(),P(),q(),x(),U=v(h),U._=y,U},{parse:N,parseArgv:function(e){return N(e,{slice:2})},generateHelp:h(r),generateHelpForOption:y(R,r)}},O.VERSION=r,module.exports=O}).call(this);