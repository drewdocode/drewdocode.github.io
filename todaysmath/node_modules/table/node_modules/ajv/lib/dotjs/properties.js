module.exports=function(e,r,a){var t=" ",o=e.level,s=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),h=e.errSchemaPath+"/"+r,p=!e.opts.allErrors,d="data"+(s||""),P="errs__"+o,n=e.util.copy(e),v="";n.level++;var c="valid"+n.level,u="key"+o,f="idx"+o,m=n.dataLevel=e.dataLevel+1,g="data"+m,y="dataProperties"+o,b=Object.keys(i||{}),S=e.schema.patternProperties||{},E=Object.keys(S),R=e.schema.additionalProperties,O=b.length||E.length,j=!1===R,k="object"==typeof R&&Object.keys(R).length,w=e.opts.removeAdditional,Q=j||k||w,_=e.opts.ownProperties,A=e.baseId,D=e.schema.required;if(D&&(!e.opts.v5||!D.$data)&&D.length<e.opts.loopRequired)var q=e.util.toHash(D);if(t+="var "+P+" = errors;var "+c+" = true;",_&&(t+=" var "+y+" = undefined;"),Q){if(t+=_?" "+y+" = "+y+" || Object.keys("+d+"); for (var "+f+"=0; "+f+"<"+y+".length; "+f+"++) { var "+u+" = "+y+"["+f+"]; ":" for (var "+u+" in "+d+") { ",O){if(t+=" var isAdditional"+o+" = !(false ",b.length)if(b.length>5)t+=" || validate.schema"+l+"["+u+"] ";else{var x=b;if(x)for(var I,L=-1,H=x.length-1;L<H;)I=x[L+=1],t+=" || "+u+" == "+e.util.toQuotedString(I)+" "}if(E.length){var U=E;if(U)for(var F,V=-1,C=U.length-1;V<C;)F=U[V+=1],t+=" || "+e.usePattern(F)+".test("+u+") "}t+=" ); if (isAdditional"+o+") { "}if("all"==w)t+=" delete "+d+"["+u+"]; ";else{var N=e.errorPath,T="' + "+u+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,u,e.opts.jsonPointers)),j)if(w)t+=" delete "+d+"["+u+"]; ";else{t+=" "+c+" = false; ";var $=h;h=e.errSchemaPath+"/additionalProperties";var z=z||[];z.push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { additionalProperty: '"+T+"' } ",!1!==e.opts.messages&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),t+=" } "):t+=" {} ";var B=t;t=z.pop(),!e.compositeRule&&p?e.async?t+=" throw new ValidationError(["+B+"]); ":t+=" validate.errors = ["+B+"]; return false; ":t+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h=$,p&&(t+=" break; ")}else if(k)if("failing"==w){t+=" var "+P+" = errors;  ";var G=e.compositeRule;e.compositeRule=n.compositeRule=!0,n.schema=R,n.schemaPath=e.schemaPath+".additionalProperties",n.errSchemaPath=e.errSchemaPath+"/additionalProperties",n.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,u,e.opts.jsonPointers);var J=d+"["+u+"]";n.dataPathArr[m]=u;var K=e.validate(n);n.baseId=A,e.util.varOccurences(K,g)<2?t+=" "+e.util.varReplace(K,g,J)+" ":t+=" var "+g+" = "+J+"; "+K+" ",t+=" if (!"+c+") { errors = "+P+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+d+"["+u+"]; }  ",e.compositeRule=n.compositeRule=G}else{n.schema=R,n.schemaPath=e.schemaPath+".additionalProperties",n.errSchemaPath=e.errSchemaPath+"/additionalProperties",n.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,u,e.opts.jsonPointers);var J=d+"["+u+"]";n.dataPathArr[m]=u;var K=e.validate(n);n.baseId=A,e.util.varOccurences(K,g)<2?t+=" "+e.util.varReplace(K,g,J)+" ":t+=" var "+g+" = "+J+"; "+K+" ",p&&(t+=" if (!"+c+") break; ")}e.errorPath=N}O&&(t+=" } "),t+=" }  ",p&&(t+=" if ("+c+") { ",v+="}")}var M=e.opts.useDefaults&&!e.compositeRule;if(b.length){var W=b;if(W)for(var I,X=-1,Y=W.length-1;X<Y;){I=W[X+=1];var Z=i[I];if(e.util.schemaHasRules(Z,e.RULES.all)){var ee=e.util.getProperty(I),J=d+ee,re=M&&void 0!==Z.default;n.schema=Z,n.schemaPath=l+ee,n.errSchemaPath=h+"/"+e.util.escapeFragment(I),n.errorPath=e.util.getPath(e.errorPath,I,e.opts.jsonPointers),n.dataPathArr[m]=e.util.toQuotedString(I);var K=e.validate(n);if(n.baseId=A,e.util.varOccurences(K,g)<2){K=e.util.varReplace(K,g,J);var ae=J}else{var ae=g;t+=" var "+g+" = "+J+"; "}if(re)t+=" "+K+" ";else{if(q&&q[I]){t+=" if ( "+ae+" === undefined ",_&&(t+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(I)+"') "),t+=") { "+c+" = false; ";var N=e.errorPath,$=h,te=e.util.escapeQuotes(I);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(N,I,e.opts.jsonPointers)),h=e.errSchemaPath+"/required";var z=z||[];z.push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { missingProperty: '"+te+"' } ",!1!==e.opts.messages&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+te+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),t+=" } "):t+=" {} ";var B=t;t=z.pop(),!e.compositeRule&&p?e.async?t+=" throw new ValidationError(["+B+"]); ":t+=" validate.errors = ["+B+"]; return false; ":t+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h=$,e.errorPath=N,t+=" } else { "}else p?(t+=" if ( "+ae+" === undefined ",_&&(t+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(I)+"') "),t+=") { "+c+" = true; } else { "):(t+=" if ("+ae+" !== undefined ",_&&(t+=" &&   Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(I)+"') "),t+=" ) { ");t+=" "+K+" } "}}p&&(t+=" if ("+c+") { ",v+="}")}}if(E.length){var oe=E;if(oe)for(var F,se=-1,ie=oe.length-1;se<ie;){F=oe[se+=1];var Z=S[F];if(e.util.schemaHasRules(Z,e.RULES.all)){n.schema=Z,n.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(F),n.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(F),t+=_?" "+y+" = "+y+" || Object.keys("+d+"); for (var "+f+"=0; "+f+"<"+y+".length; "+f+"++) { var "+u+" = "+y+"["+f+"]; ":" for (var "+u+" in "+d+") { ",t+=" if ("+e.usePattern(F)+".test("+u+")) { ",n.errorPath=e.util.getPathExpr(e.errorPath,u,e.opts.jsonPointers);var J=d+"["+u+"]";n.dataPathArr[m]=u;var K=e.validate(n);n.baseId=A,e.util.varOccurences(K,g)<2?t+=" "+e.util.varReplace(K,g,J)+" ":t+=" var "+g+" = "+J+"; "+K+" ",p&&(t+=" if (!"+c+") break; "),t+=" } ",p&&(t+=" else "+c+" = true; "),t+=" }  ",p&&(t+=" if ("+c+") { ",v+="}")}}}return p&&(t+=" "+v+" if ("+P+" == errors) {"),t=e.util.cleanUpCode(t)};