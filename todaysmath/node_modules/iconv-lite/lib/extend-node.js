var Buffer=require("buffer").Buffer;module.exports=function(e){var t=void 0;e.supportsNodeEncodingsExtension=!(new Buffer(0)instanceof Uint8Array),e.extendNodeEncodings=function(){if(!t){if(t={},!e.supportsNodeEncodingsExtension)return console.error("ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node"),void console.error("See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility");var r={hex:!0,utf8:!0,"utf-8":!0,ascii:!0,binary:!0,base64:!0,ucs2:!0,"ucs-2":!0,utf16le:!0,"utf-16le":!0};Buffer.isNativeEncoding=function(e){return e&&r[e.toLowerCase()]};var o=require("buffer").SlowBuffer;if(t.SlowBufferToString=o.prototype.toString,o.prototype.toString=function(r,o,i){return r=String(r||"utf8").toLowerCase(),Buffer.isNativeEncoding(r)?t.SlowBufferToString.call(this,r,o,i):(void 0===o&&(o=0),void 0===i&&(i=this.length),e.decode(this.slice(o,i),r))},t.SlowBufferWrite=o.prototype.write,o.prototype.write=function(r,o,i,n){if(isFinite(o))isFinite(i)||(n=i,i=void 0);else{var f=n;n=o,o=i,i=f}o=+o||0;var u=this.length-o;if(i?(i=+i)>u&&(i=u):i=u,n=String(n||"utf8").toLowerCase(),Buffer.isNativeEncoding(n))return t.SlowBufferWrite.call(this,r,o,i,n);if(r.length>0&&(i<0||o<0))throw new RangeError("attempt to write beyond buffer bounds");var s=e.encode(r,n);return s.length<i&&(i=s.length),s.copy(this,o,0,i),i},t.BufferIsEncoding=Buffer.isEncoding,Buffer.isEncoding=function(t){return Buffer.isNativeEncoding(t)||e.encodingExists(t)},t.BufferByteLength=Buffer.byteLength,Buffer.byteLength=o.byteLength=function(r,o){return o=String(o||"utf8").toLowerCase(),Buffer.isNativeEncoding(o)?t.BufferByteLength.call(this,r,o):e.encode(r,o).length},t.BufferToString=Buffer.prototype.toString,Buffer.prototype.toString=function(r,o,i){return r=String(r||"utf8").toLowerCase(),Buffer.isNativeEncoding(r)?t.BufferToString.call(this,r,o,i):(void 0===o&&(o=0),void 0===i&&(i=this.length),e.decode(this.slice(o,i),r))},t.BufferWrite=Buffer.prototype.write,Buffer.prototype.write=function(r,o,i,n){var f=o,u=i,s=n;if(isFinite(o))isFinite(i)||(n=i,i=void 0);else{var d=n;n=o,o=i,i=d}if(n=String(n||"utf8").toLowerCase(),Buffer.isNativeEncoding(n))return t.BufferWrite.call(this,r,f,u,s);o=+o||0;var c=this.length-o;if(i?(i=+i)>c&&(i=c):i=c,r.length>0&&(i<0||o<0))throw new RangeError("attempt to write beyond buffer bounds");var g=e.encode(r,n);return g.length<i&&(i=g.length),g.copy(this,o,0,i),i},e.supportsStreams){var i=require("stream").Readable;t.ReadableSetEncoding=i.prototype.setEncoding,i.prototype.setEncoding=function(t,r){this._readableState.decoder=e.getDecoder(t,r),this._readableState.encoding=t},i.prototype.collect=e._collect}}},e.undoExtendNodeEncodings=function(){if(e.supportsNodeEncodingsExtension){if(!t)throw new Error("require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.");delete Buffer.isNativeEncoding;var r=require("buffer").SlowBuffer;if(r.prototype.toString=t.SlowBufferToString,r.prototype.write=t.SlowBufferWrite,Buffer.isEncoding=t.BufferIsEncoding,Buffer.byteLength=t.BufferByteLength,Buffer.prototype.toString=t.BufferToString,Buffer.prototype.write=t.BufferWrite,e.supportsStreams){var o=require("stream").Readable;o.prototype.setEncoding=t.ReadableSetEncoding,delete o.prototype.collect}t=void 0}}};