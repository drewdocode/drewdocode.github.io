var isPromise=require("is-promise"),runAsync=module.exports=function(n,r){return r=r||function(){},function(){var t=!1,e=arguments,i=new Promise(function(r,i){var u=n.apply({async:function(){return t=!0,function(n,t){n?i(n):r(t)}}},Array.prototype.slice.call(e));t||(isPromise(u)?u.then(r,i):r(u))});return i.then(r.bind(null,null),r),i}};runAsync.cb=function(n,r){return runAsync(function(){var r=Array.prototype.slice.call(arguments);return r.length===n.length-1&&r.push(this.async()),n.apply(this,r)},r)};