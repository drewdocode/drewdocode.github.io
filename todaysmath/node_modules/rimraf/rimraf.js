function defaults(r){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(i){r[i]=r[i]||fs[i],i+="Sync",r[i]=r[i]||fs[i]}),r.maxBusyTries=r.maxBusyTries||3,r.emfileWait=r.emfileWait||1e3,!1===r.glob&&(r.disableGlob=!0),r.disableGlob=r.disableGlob||!1,r.glob=r.glob||defaultGlobOpts}function rimraf(r,i,t){function n(r){s=s||r,0==--a&&t(s)}function e(r,e){return r?t(r):0===(a=e.length)?t():void e.forEach(function(r){rimraf_(r,i,function t(e){if(e){if(("EBUSY"===e.code||"ENOTEMPTY"===e.code||"EPERM"===e.code)&&o<i.maxBusyTries){o++;var s=100*o;return setTimeout(function(){rimraf_(r,i,t)},s)}if("EMFILE"===e.code&&timeout<i.emfileWait)return setTimeout(function(){rimraf_(r,i,t)},timeout++);"ENOENT"===e.code&&(e=null)}timeout=0,n(e)})})}"function"==typeof i&&(t=i,i={}),assert(r,"rimraf: missing path"),assert.equal(typeof r,"string","rimraf: path should be a string"),assert.equal(typeof t,"function","rimraf: callback function required"),assert(i,"rimraf: invalid options argument provided"),assert.equal(typeof i,"object","rimraf: options should be object"),defaults(i);var o=0,s=null,a=0;if(i.disableGlob||!glob.hasMagic(r))return e(null,[r]);i.lstat(r,function(t,n){if(!t)return e(null,[r]);glob(r,i.glob,e)})}function rimraf_(r,i,t){assert(r),assert(i),assert("function"==typeof t),i.lstat(r,function(n,e){return n&&"ENOENT"===n.code?t(null):(n&&"EPERM"===n.code&&isWindows&&fixWinEPERM(r,i,n,t),e&&e.isDirectory()?rmdir(r,i,n,t):void i.unlink(r,function(n){if(n){if("ENOENT"===n.code)return t(null);if("EPERM"===n.code)return isWindows?fixWinEPERM(r,i,n,t):rmdir(r,i,n,t);if("EISDIR"===n.code)return rmdir(r,i,n,t)}return t(n)}))})}function fixWinEPERM(r,i,t,n){assert(r),assert(i),assert("function"==typeof n),t&&assert(t instanceof Error),i.chmod(r,_0666,function(e){e?n("ENOENT"===e.code?null:t):i.stat(r,function(e,o){e?n("ENOENT"===e.code?null:t):o.isDirectory()?rmdir(r,i,t,n):i.unlink(r,n)})})}function fixWinEPERMSync(r,i,t){assert(r),assert(i),t&&assert(t instanceof Error);try{i.chmodSync(r,_0666)}catch(r){if("ENOENT"===r.code)return;throw t}try{var n=i.statSync(r)}catch(r){if("ENOENT"===r.code)return;throw t}n.isDirectory()?rmdirSync(r,i,t):i.unlinkSync(r)}function rmdir(r,i,t,n){assert(r),assert(i),t&&assert(t instanceof Error),assert("function"==typeof n),i.rmdir(r,function(e){!e||"ENOTEMPTY"!==e.code&&"EEXIST"!==e.code&&"EPERM"!==e.code?n(e&&"ENOTDIR"===e.code?t:e):rmkids(r,i,n)})}function rmkids(r,i,t){assert(r),assert(i),assert("function"==typeof t),i.readdir(r,function(n,e){if(n)return t(n);var o=e.length;if(0===o)return i.rmdir(r,t);var s;e.forEach(function(n){rimraf(path.join(r,n),i,function(n){if(!s)return n?t(s=n):void(0==--o&&i.rmdir(r,t))})})})}function rimrafSync(r,i){i=i||{},defaults(i),assert(r,"rimraf: missing path"),assert.equal(typeof r,"string","rimraf: path should be a string"),assert(i,"rimraf: missing options"),assert.equal(typeof i,"object","rimraf: options should be object");var t;if(i.disableGlob||!glob.hasMagic(r))t=[r];else try{i.lstatSync(r),t=[r]}catch(n){t=glob.sync(r,i.glob)}if(t.length)for(var n=0;n<t.length;n++){var r=t[n];try{var e=i.lstatSync(r)}catch(t){if("ENOENT"===t.code)return;"EPERM"===t.code&&isWindows&&fixWinEPERMSync(r,i,t)}try{e&&e.isDirectory()?rmdirSync(r,i,null):i.unlinkSync(r)}catch(t){if("ENOENT"===t.code)return;if("EPERM"===t.code)return isWindows?fixWinEPERMSync(r,i,t):rmdirSync(r,i,t);if("EISDIR"!==t.code)throw t;rmdirSync(r,i,t)}}}function rmdirSync(r,i,t){assert(r),assert(i),t&&assert(t instanceof Error);try{i.rmdirSync(r)}catch(n){if("ENOENT"===n.code)return;if("ENOTDIR"===n.code)throw t;"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code||rmkidsSync(r,i)}}function rmkidsSync(r,i){assert(r),assert(i),i.readdirSync(r).forEach(function(t){rimrafSync(path.join(r,t),i)});for(var t=isWindows?100:1,n=0;;){var e=!0;try{var o=i.rmdirSync(r,i);return e=!1,o}finally{if(++n<t&&e)continue}}}module.exports=rimraf,rimraf.sync=rimrafSync;var assert=require("assert"),path=require("path"),fs=require("fs"),glob=require("glob"),_0666=parseInt("666",8),defaultGlobOpts={nosort:!0,silent:!0},timeout=0,isWindows="win32"===process.platform;