function parseNonShell(e){var s,r,n;return isWin?(e.file=resolveCommand(e.command),e.file=e.file||resolveCommand(e.command,!0),s=e.file&&readShebang(e.file),s?(e.args.unshift(e.file),e.command=s,r=hasEmptyArgumentBug||!skipShellRegExp.test(resolveCommand(s)||resolveCommand(s,!0))):r=hasEmptyArgumentBug||!skipShellRegExp.test(e.file),r&&(n="echo"!==e.command,e.command=escapeCommand(e.command),e.args=e.args.map(function(e){return escapeArgument(e,n)}),e.args=["/d","/s","/c",'"'+e.command+(e.args.length?" "+e.args.join(" "):"")+'"'],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0),e):e}function parseShell(e){var s;return supportsShellOption?e:(s=[e.command].concat(e.args).join(" "),isWin?(e.command="string"==typeof e.options.shell?e.options.shell:process.env.comspec||"cmd.exe",e.args=["/d","/s","/c",'"'+s+'"'],e.options.windowsVerbatimArguments=!0):("string"==typeof e.options.shell?e.command=e.options.shell:"android"===process.platform?e.command="/system/bin/sh":e.command="/bin/sh",e.args=["-c",s]),e)}function parse(e,s,r){var n;return s&&!Array.isArray(s)&&(r=s,s=null),s=s?s.slice(0):[],r=r||{},n={command:e,args:s,options:r,file:void 0,original:e},r.shell?parseShell(n):parseNonShell(n)}var resolveCommand=require("./util/resolveCommand"),hasEmptyArgumentBug=require("./util/hasEmptyArgumentBug"),escapeArgument=require("./util/escapeArgument"),escapeCommand=require("./util/escapeCommand"),readShebang=require("./util/readShebang"),isWin="win32"===process.platform,skipShellRegExp=/\.(?:com|exe)$/i,supportsShellOption=parseInt(process.version.substr(1).split(".")[0],10)>=6||4===parseInt(process.version.substr(1).split(".")[0],10)&&parseInt(process.version.substr(1).split(".")[1],10)>=8;module.exports=parse;