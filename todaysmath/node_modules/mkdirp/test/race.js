var mkdirp=require("../").mkdirp,path=require("path"),fs=require("fs"),exists=fs.exists||path.exists,test=require("tap").test,_0777=parseInt("0777",8),_0755=parseInt("0755",8);test("race",function(t){function r(r,e){mkdirp(r,_0755,function(e){t.ifError(e),exists(r,function(e){t.ok(e,"file created"),fs.stat(r,function(r,e){t.ifError(r),t.equal(e.mode&_0777,_0755),t.ok(e.isDirectory(),"target not a directory")})})})}t.plan(10);for(var e=["","tmp"],i=0;i<25;i++){var a=Math.floor(Math.random()*Math.pow(16,4)).toString(16);e.push(a)}var o=e.join("/");r(o),r(o)});