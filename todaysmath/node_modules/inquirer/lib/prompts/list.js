function Prompt(){Base.apply(this,arguments),this.opt.choices||this.throwParamError("choices"),this.firstRender=!0,this.selected=0;var e=this.opt.default;_.isNumber(e)&&e>=0&&e<this.opt.choices.realLength?this.selected=e:_.isNumber(e)||null==e||(this.selected=this.opt.choices.pluck("value").indexOf(e)),this.opt.default=null,this.paginator=new Paginator}function listRender(e,t){var i="",r=0;return e.forEach(function(e,s){if("separator"===e.type)return r++,void(i+="  "+e+"\n");if(e.disabled)return r++,i+="  - "+e.name,i+=" ("+(_.isString(e.disabled)?e.disabled:"Disabled")+")",void(i+="\n");var n=s-r===t,o=(n?figures.pointer+" ":"  ")+e.name;n&&(o=chalk.cyan(o)),i+=o+" \n"}),i.replace(/\n$/,"")}var _=require("lodash"),util=require("util"),chalk=require("chalk"),figures=require("figures"),cliCursor=require("cli-cursor"),runAsync=require("run-async"),Base=require("./base"),observe=require("../utils/events"),Paginator=require("../utils/paginator");module.exports=Prompt,util.inherits(Prompt,Base),Prompt.prototype._run=function(e){this.done=e;var t=this,i=observe(this.rl);return i.normalizedUpKey.takeUntil(i.line).forEach(this.onUpKey.bind(this)),i.normalizedDownKey.takeUntil(i.line).forEach(this.onDownKey.bind(this)),i.numberKey.takeUntil(i.line).forEach(this.onNumberKey.bind(this)),i.line.take(1).map(this.getCurrentValue.bind(this)).flatMap(function(e){return runAsync(t.opt.filter)(e).catch(function(e){return e})}).forEach(this.onSubmit.bind(this)),cliCursor.hide(),this.render(),this},Prompt.prototype.render=function(){var e=this.getQuestion();if(this.firstRender&&(e+=chalk.dim("(Use arrow keys)")),"answered"===this.status)e+=chalk.cyan(this.opt.choices.getChoice(this.selected).short);else{var t=listRender(this.opt.choices,this.selected),i=this.opt.choices.indexOf(this.opt.choices.getChoice(this.selected));e+="\n"+this.paginator.paginate(t,i,this.opt.pageSize)}this.firstRender=!1,this.screen.render(e)},Prompt.prototype.onSubmit=function(e){this.status="answered",this.render(),this.screen.done(),cliCursor.show(),this.done(e)},Prompt.prototype.getCurrentValue=function(){return this.opt.choices.getChoice(this.selected).value},Prompt.prototype.onUpKey=function(){var e=this.opt.choices.realLength;this.selected=this.selected>0?this.selected-1:e-1,this.render()},Prompt.prototype.onDownKey=function(){var e=this.opt.choices.realLength;this.selected=this.selected<e-1?this.selected+1:0,this.render()},Prompt.prototype.onNumberKey=function(e){e<=this.opt.choices.realLength&&(this.selected=e-1),this.render()};