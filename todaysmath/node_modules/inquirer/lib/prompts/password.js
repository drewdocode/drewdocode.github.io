function mask(t,e){return t=String(t),e="string"==typeof e?e:"*",0===t.length?"":new Array(t.length+1).join(e)}function Prompt(){return Base.apply(this,arguments)}var util=require("util"),chalk=require("chalk"),Base=require("./base"),observe=require("../utils/events");module.exports=Prompt,util.inherits(Prompt,Base),Prompt.prototype._run=function(t){this.done=t;var e=observe(this.rl),r=e.line.map(this.filterInput.bind(this)),s=this.handleSubmitEvents(r);return s.success.forEach(this.onEnd.bind(this)),s.error.forEach(this.onError.bind(this)),this.opt.mask&&e.keypress.takeUntil(s.success).forEach(this.onKeypress.bind(this)),this.render(),this},Prompt.prototype.render=function(t){var e=this.getQuestion(),r="";"answered"===this.status?e+=this.opt.mask?chalk.cyan(mask(this.answer,this.opt.mask)):chalk.italic.dim("[hidden]"):this.opt.mask?e+=mask(this.rl.line||"",this.opt.mask):e+=chalk.italic.dim("[input is hidden] "),t&&(r="\n"+chalk.red(">> ")+t),this.screen.render(e,r)},Prompt.prototype.filterInput=function(t){return t||(null==this.opt.default?"":this.opt.default)},Prompt.prototype.onEnd=function(t){this.status="answered",this.answer=t.value,this.render(),this.screen.done(),this.done(t.value)},Prompt.prototype.onError=function(t){this.render(t.isValid)},Prompt.prototype.onKeypress=function(){this.render()};