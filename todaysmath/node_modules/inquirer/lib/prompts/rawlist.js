function Prompt(){Base.apply(this,arguments),this.opt.choices||this.throwParamError("choices"),this.opt.validChoices=this.opt.choices.filter(Separator.exclude),this.selected=0,this.rawDefault=0,_.extend(this.opt,{validate:function(e){return null!=e}});var e=this.opt.default;_.isNumber(e)&&e>=0&&e<this.opt.choices.realLength&&(this.selected=this.rawDefault=e),this.opt.default=null,this.paginator=new Paginator}function renderChoices(e,t){var r="",i=0;return e.forEach(function(e,s){if(r+="\n  ","separator"===e.type)return i++,void(r+=" "+e);var n=s-i,o=n+1+") "+e.name;n===t&&(o=chalk.cyan(o)),r+=o}),r}var _=require("lodash"),util=require("util"),chalk=require("chalk"),Base=require("./base"),Separator=require("../objects/separator"),observe=require("../utils/events"),Paginator=require("../utils/paginator");module.exports=Prompt,util.inherits(Prompt,Base),Prompt.prototype._run=function(e){this.done=e;var t=observe(this.rl),r=t.line.map(this.getCurrentValue.bind(this)),i=this.handleSubmitEvents(r);return i.success.forEach(this.onEnd.bind(this)),i.error.forEach(this.onError.bind(this)),t.keypress.takeUntil(i.success).forEach(this.onKeypress.bind(this)),this.render(),this},Prompt.prototype.render=function(e){var t=this.getQuestion(),r="";if("answered"===this.status)t+=chalk.cyan(this.answer);else{var i=renderChoices(this.opt.choices,this.selected);t+=this.paginator.paginate(i,this.selected,this.opt.pageSize),t+="\n  Answer: "}t+=this.rl.line,e&&(r="\n"+chalk.red(">> ")+e),this.screen.render(t,r)},Prompt.prototype.getCurrentValue=function(e){null==e||""===e?e=this.rawDefault:e-=1;var t=this.opt.choices.getChoice(e);return t?t.value:null},Prompt.prototype.onEnd=function(e){this.status="answered",this.answer=e.value,this.render(),this.screen.done(),this.done(e.value)},Prompt.prototype.onError=function(){this.render("Please enter a valid index")},Prompt.prototype.onKeypress=function(){var e=this.rl.line.length?Number(this.rl.line)-1:0;this.opt.choices.getChoice(e)?this.selected=e:this.selected=void 0,this.render()};