function Prompt(){return Base.apply(this,arguments)}var util=require("util"),chalk=require("chalk"),ExternalEditor=require("external-editor"),Base=require("./base"),observe=require("../utils/events"),rx=require("rx-lite-aggregates");module.exports=Prompt,util.inherits(Prompt,Base),Prompt.prototype._run=function(t){this.done=t,this.editorResult=new rx.Subject;var e=observe(this.rl);this.lineSubscription=e.line.forEach(this.startExternalEditor.bind(this));var r=this.handleSubmitEvents(this.editorResult);return r.success.forEach(this.onEnd.bind(this)),r.error.forEach(this.onError.bind(this)),this.currentText=this.opt.default,this.opt.default=null,this.render(),this},Prompt.prototype.render=function(t){var e="",r=this.getQuestion();"answered"===this.status?r+=chalk.dim("Received"):r+=chalk.dim("Press <enter> to launch your preferred editor."),t&&(e=chalk.red(">> ")+t),this.screen.render(r,e)},Prompt.prototype.startExternalEditor=function(){this.rl.pause(),ExternalEditor.editAsync(this.currentText,this.endExternalEditor.bind(this))},Prompt.prototype.endExternalEditor=function(t,e){this.rl.resume(),t?this.editorResult.onError(t):this.editorResult.onNext(e)},Prompt.prototype.onEnd=function(t){this.editorResult.dispose(),this.lineSubscription.dispose(),this.answer=t.value,this.status="answered",this.render(),this.screen.done(),this.done(this.answer)},Prompt.prototype.onError=function(t){this.render(t.isValid)};