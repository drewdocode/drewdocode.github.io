function setupReadlineOptions(e){e=e||{};var t=e.input||process.stdin,o=new MuteStream;o.pipe(e.output||process.stdout);var s=o;return _.extend({terminal:!0,input:t,output:s},_.omit(e,["input","output"]))}var _=require("lodash"),MuteStream=require("mute-stream"),readline=require("readline"),UI=module.exports=function(e){this.rl||(this.rl=readline.createInterface(setupReadlineOptions(e))),this.rl.resume(),this.onForceClose=this.onForceClose.bind(this),process.on("exit",this.onForceClose),this.rl.on("SIGINT",this.onForceClose)};UI.prototype.onForceClose=function(){this.close(),process.kill(process.pid,"SIGINT"),console.log("")},UI.prototype.close=function(){this.rl.removeListener("SIGINT",this.onForceClose),process.removeListener("exit",this.onForceClose),this.rl.output.unmute(),this.activePrompt&&"function"==typeof this.activePrompt.close&&this.activePrompt.close(),this.rl.output.end(),this.rl.pause(),this.rl.close()};