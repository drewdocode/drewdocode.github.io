module.exports=function(e,r,a){function t(e){for(var r=e.rules,a=0;a<r.length;a++)if(s(r[a]))return!0}function s(r){return void 0!==e.schema[r.keyword]||r.implements&&o(r)}function o(r){for(var a=r.implements,t=0;t<a.length;t++)if(void 0!==e.schema[a[t]])return!0}var i="",l=!0===e.schema.$async,n=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),h=e.self._getId(e.schema);if(e.isTop){if(l){e.async=!0;var p="es7"==e.opts.async;e.yieldAwait=p?"await":"yield"}i+=" var validate = ",l?p?i+=" (async function ":("*"!=e.opts.async&&(i+="co.wrap"),i+="(function* "):i+=" (function ",i+=" (data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",h&&(e.opts.sourceCode||e.opts.processCode)&&(i+=" /*# sourceURL="+h+" */ ")}if("boolean"==typeof e.schema||!n&&!e.schema.$ref){var d,c=e.level,f=e.dataLevel,u=e.schema["false schema"],v=e.schemaPath+e.util.getProperty("false schema"),m=e.errSchemaPath+"/false schema",y=!e.opts.allErrors,P="data"+(f||""),g="valid"+c;if(!1===e.schema){e.isTop?y=!0:i+=" var "+g+" = false; ";var E=E||[];E.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(d||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'boolean schema is false' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),i+=" } "):i+=" {} ";var w=i;i=E.pop(),!e.compositeRule&&y?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?i+=l?" return data; ":" validate.errors = null; return true; ":i+=" var "+g+" = true; ";return e.isTop&&(i+=" }); return validate; "),i}if(e.isTop){var b=e.isTop,c=e.level=0,f=e.dataLevel=0,P="data";e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],i+=" var vErrors = null; ",i+=" var errors = 0;     ",i+=" if (rootData === undefined) rootData = data; "}else{var c=e.level,f=e.dataLevel,P="data"+(f||"");if(h&&(e.baseId=e.resolve.url(e.baseId,h)),l&&!e.async)throw new Error("async schema in sync schema");i+=" var errs_"+c+" = errors;"}var d,g="valid"+c,y=!e.opts.allErrors,S="",T="",D=e.schema.type,R=Array.isArray(D);if(R&&1==D.length&&(D=D[0],R=!1),e.schema.$ref&&n){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(n=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(D){if(e.opts.coerceTypes)var k=e.util.coerceToTypes(e.opts.coerceTypes,D);var j=e.RULES.types[D];if(k||R||!0===j||j&&!t(j)){var v=e.schemaPath+".type",m=e.errSchemaPath+"/type",v=e.schemaPath+".type",m=e.errSchemaPath+"/type",A=R?"checkDataTypes":"checkDataType";if(i+=" if ("+e.util[A](D,P,!0)+") { ",k){var $="dataType"+c,I="coerced"+c;i+=" var "+$+" = typeof "+P+"; ","array"==e.opts.coerceTypes&&(i+=" if ("+$+" == 'object' && Array.isArray("+P+")) "+$+" = 'array'; "),i+=" var "+I+" = undefined; ";var L="",U=k;if(U)for(var _,x=-1,C=U.length-1;x<C;)_=U[x+=1],x&&(i+=" if ("+I+" === undefined) { ",L+="}"),"array"==e.opts.coerceTypes&&"array"!=_&&(i+=" if ("+$+" == 'array' && "+P+".length == 1) { "+I+" = "+P+" = "+P+"[0]; "+$+" = typeof "+P+";  } "),"string"==_?i+=" if ("+$+" == 'number' || "+$+" == 'boolean') "+I+" = '' + "+P+"; else if ("+P+" === null) "+I+" = ''; ":"number"==_||"integer"==_?(i+=" if ("+$+" == 'boolean' || "+P+" === null || ("+$+" == 'string' && "+P+" && "+P+" == +"+P+" ","integer"==_&&(i+=" && !("+P+" % 1)"),i+=")) "+I+" = +"+P+"; "):"boolean"==_?i+=" if ("+P+" === 'false' || "+P+" === 0 || "+P+" === null) "+I+" = false; else if ("+P+" === 'true' || "+P+" === 1) "+I+" = true; ":"null"==_?i+=" if ("+P+" === '' || "+P+" === 0 || "+P+" === false) "+I+" = null; ":"array"==e.opts.coerceTypes&&"array"==_&&(i+=" if ("+$+" == 'string' || "+$+" == 'number' || "+$+" == 'boolean' || "+P+" == null) "+I+" = ["+P+"]; ");i+=" "+L+" if ("+I+" === undefined) {   ";var E=E||[];E.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(d||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=R?""+D.join(","):""+D,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=R?""+D.join(","):""+D,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+v+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),i+=" } "):i+=" {} ";var w=i;i=E.pop(),!e.compositeRule&&y?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  ";var V=f?"data"+(f-1||""):"parentData",Q=f?e.dataPathArr[f]:"parentDataProperty";i+=" "+P+" = "+I+"; ",f||(i+="if ("+V+" !== undefined)"),i+=" "+V+"["+Q+"] = "+I+"; } "}else{var E=E||[];E.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(d||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=R?""+D.join(","):""+D,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=R?""+D.join(","):""+D,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+v+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),i+=" } "):i+=" {} ";var w=i;i=E.pop(),!e.compositeRule&&y?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}i+=" } "}}if(e.schema.$ref&&!n)i+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",y&&(i+=" } if (errors === ",i+=b?"0":"errs_"+c,i+=") { ",T+="}");else{e.opts.v5&&e.schema.patternGroups&&e.logger.warn('keyword "patternGroups" is deprecated and disabled. Use option patternGroups: true to enable.');var G=e.RULES;if(G)for(var j,O=-1,J=G.length-1;O<J;)if(j=G[O+=1],t(j)){if(j.type&&(i+=" if ("+e.util.checkDataType(j.type,P)+") { "),e.opts.useDefaults&&!e.compositeRule)if("object"==j.type&&e.schema.properties){var u=e.schema.properties,N=Object.keys(u),H=N;if(H)for(var q,z=-1,B=H.length-1;z<B;){q=H[z+=1];var F=u[q];if(void 0!==F.default){var K=P+e.util.getProperty(q);i+="  if ("+K+" === undefined) "+K+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(F.default)+" ":i+=" "+JSON.stringify(F.default)+" ",i+="; "}}}else if("array"==j.type&&Array.isArray(e.schema.items)){var M=e.schema.items;if(M)for(var F,x=-1,W=M.length-1;x<W;)if(F=M[x+=1],void 0!==F.default){var K=P+"["+x+"]";i+="  if ("+K+" === undefined) "+K+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(F.default)+" ":i+=" "+JSON.stringify(F.default)+" ",i+="; "}}var X=j.rules;if(X)for(var Y,Z=-1,ee=X.length-1;Z<ee;)if(Y=X[Z+=1],s(Y)){var re=Y.code(e,Y.keyword,j.type);re&&(i+=" "+re+" ",y&&(S+="}"))}if(y&&(i+=" "+S+" ",S=""),j.type&&(i+=" } ",D&&D===j.type&&!k)){i+=" else { ";var v=e.schemaPath+".type",m=e.errSchemaPath+"/type",E=E||[];E.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(d||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=R?""+D.join(","):""+D,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=R?""+D.join(","):""+D,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+v+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),i+=" } "):i+=" {} ";var w=i;i=E.pop(),!e.compositeRule&&y?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } "}y&&(i+=" if (errors === ",i+=b?"0":"errs_"+c,i+=") { ",T+="}")}}return y&&(i+=" "+T+" "),b?(l?(i+=" if (errors === 0) return data;           ",i+=" else throw new ValidationError(vErrors); "):(i+=" validate.errors = vErrors; ",i+=" return errors === 0;       "),i+=" }); return validate;"):i+=" var "+g+" = errors === errs_"+c+";",i=e.util.cleanUpCode(i),b&&(i=e.util.finalCleanUpCode(i,l)),i};