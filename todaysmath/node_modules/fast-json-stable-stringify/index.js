module.exports=function(r,n){n||(n={}),"function"==typeof n&&(n={cmp:n});var t="boolean"==typeof n.cycles&&n.cycles,e=n.cmp&&function(r){return function(n){return function(t,e){var i={key:t,value:n[t]},u={key:e,value:n[e]};return r(i,u)}}}(n.cmp),i=[];return function r(n){if(n&&n.toJSON&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0!==n){if("number"==typeof n)return isFinite(n)?""+n:"null";if("object"!=typeof n)return JSON.stringify(n);var u,o;if(Array.isArray(n)){for(o="[",u=0;u<n.length;u++)u&&(o+=","),o+=r(n[u])||"null";return o+"]"}if(null===n)return"null";if(-1!==i.indexOf(n)){if(t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var f=i.push(n)-1,c=Object.keys(n).sort(e&&e(n));for(o="",u=0;u<c.length;u++){var l=c[u],y=r(n[l]);y&&(o&&(o+=","),o+=JSON.stringify(l)+":"+y)}return i.splice(f,1),"{"+o+"}"}}(r)};